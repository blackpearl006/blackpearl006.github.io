<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd"> <html><body> <p><em>A article on best practices to download, perform quality control, extract morphometric features, harmonise &amp; normalise</em></p> <h3>Downloading MRI data</h3> <p>Based on your problem statement you can choose the dataset what you would like to work with. Visit <a href="https://blackpearl006.github.io/NeuroDataHub/">https://blackpearl006.github.io/NeuroDataHub/</a> for access 50+ neuroimaging datasets. Download these images along with the relevant metadata.</p> <h3>Pipeline for morphometric features</h3> <h4>BIDS format</h4> <p>Rearrange the dataset into BIDS format. Ensure dataset description json file is present. Use <a href="https://pypi.org/project/dcm2bids/" rel="external nofollow noopener" target="_blank">dcm2bids</a> or similar packages.</p> <h4><strong>MRI-qc</strong></h4> <p>Perform automated quality control testing using the MRI-qc (<a href="https://github.com/nipreps/mriqc" rel="external nofollow noopener" target="_blank">https://github.com/nipreps/mriqc</a>). You will get various quality control parameters and design a inclusion-exclusion criterion based on your requirements. We recommend using at least 4 parameters including SNR, CNR, Coefficient of joint variation, FWHM to determine the quality of the raw image. Discard a raw image if the raw image does not have at least 3 values above the threshold.</p> <h4>Free Surfer</h4> <p>Use the recon-all command from Free Surfer. Based on the MRI image this command can take 1 to 6 hours. This command can be run in parallel assigning a single core to each subject, effectively scaling up as the number of cores in your CPU. Remember to export SUBJECTS_DIR="$pwd", else all the output files will be created in some place else. The stats folder in the output directory contains all the morphometry related information. There are 30+ steps / stages in recon-all process and any one of them can fail, this might be a ghost process. So it’s important that you check for these failures. Best practices include, logging the completion / error code for each of the process and using batches to process.</p> <h4>Free Surfer Segmentation qc</h4> <p>After the Free Surfer recon-all finishes, check whether the Free Surfer was able to correctly get the segmentation maps correct. You can either manually inspect the segmentation maps using freeview or qdec (<a href="https://surfer.nmr.mgh.harvard.edu/fswiki/QuickQaQdec" rel="external nofollow noopener" target="_blank">https://surfer.nmr.mgh.harvard.edu/fswiki/QuickQaQdec</a>).</p> <h4>Aggregating the Morphometry features</h4> <p>Using the asegstats2table (<a href="https://surfer.nmr.mgh.harvard.edu/fswiki/asegstats2table" rel="external nofollow noopener" target="_blank">https://surfer.nmr.mgh.harvard.edu/fswiki/asegstats2table</a>) &amp; aparstats2table (<a href="https://surfer.nmr.mgh.harvard.edu/fswiki/aparcstats2table" rel="external nofollow noopener" target="_blank">https://surfer.nmr.mgh.harvard.edu/fswiki/aparcstats2table</a>) aggregate all the features into a single table with Free Surfer based morphometric features as the columns and each subject as Rows.</p> <h4>Data Harmonization</h4> <p>For morphometry related features, combat-based algorithms are preferred. Data Harmonization technique can differ based on your dataset type, cross-section or longitudinal. For cross-sectional data, you can use neuroHarmonise (<a href="https://github.com/rpomponio/neuroHarmonize" rel="external nofollow noopener" target="_blank">https://github.com/rpomponio/neuroHarmonize</a>) and for longitudinal data (<a href="https://github.com/jcbeer/longCombat" rel="external nofollow noopener" target="_blank">https://github.com/jcbeer/longCombat</a>)</p> <h3>Pipeline for 3D Images</h3> <h4>Reorient MR images to Standard</h4> <p>Reorient the Raw image into the standard space using the <a href="https://ftp.nmr.mgh.harvard.edu/pub/dist/freesurfer/tutorial_packages/centos6/fsl_507/doc/wiki/Orientation(20)Explained.html" rel="external nofollow noopener" target="_blank">fslreorient2std</a>command.</p> <h4>N4 Bias Correction</h4> <p>Perform Bias Correction on the Raw images using N4BiasFieldCorrection (<a href="https://github.com/ANTsX/ANTs/wiki/N4BiasFieldCorrection" rel="external nofollow noopener" target="_blank">https://github.com/ANTsX/ANTs/wiki/N4BiasFieldCorrection</a>). This takes multiple cores to run and is computationally expensive.</p> <h4>Skull Stripping</h4> <p>Perform Skull Striping using FSL’s bet2 tool set the -f (fractional intensity parameter based on your data)</p> <h4>Registration</h4> <p>To preserve the structural information, we recommend to use Linear Registration either with 6DOF or 12DOF (effects the volume). Use FSL’s flirt tool to perform registration. If the subjects are above the age of 18 you can use the MNI152 1mm or 2mm template, if the subjects are below this age it is highly recommended to use a age-specific template (<a href="https://nist.mni.mcgill.ca/pediatric-atlases-4-5-18-5y/" rel="external nofollow noopener" target="_blank">https://nist.mni.mcgill.ca/pediatric-atlases-4-5-18-5y/</a>)</p> <h4>Normalization</h4> <p>While working with multi-site data, the voxel value distribution can vary drastically and can effect the data distribution. White Stripe Normalization (<a href="https://doi.org/10.1016/j.nicl.2014.08.008" rel="external nofollow noopener" target="_blank">https://doi.org/10.1016/j.nicl.2014.08.008</a>) takes care of this difference and brings all the MRI scans to a same voxel distribution and assigns simialr tissues with the same value.</p> <p><img src="https://medium.com/_/stat?event=post.clientViewed&amp;referrerSource=full_rss&amp;postId=67816bfc5596" width="1" height="1" alt=""></p> </body></html>